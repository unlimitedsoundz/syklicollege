module.exports=[77782,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(46504)},8649,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},53565,a=>{"use strict";var b=a.i(96350);function c(){if(!process.env.SUPABASE_SERVICE_ROLE_KEY)throw Error("Missing Supabase Service Role Key");return(0,b.createClient)("https://mrqzlmkdhzwvbpljikjz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}a.s(["createAdminClient",()=>c])},51696,a=>{"use strict";var b=a.i(77782),c=a.i(53565),d=a.i(46235);async function e(a){let b=(0,c.createAdminClient)();try{let{data:c}=await b.from("it_assets").select("*").eq("auto_provision",!0);if(!c||0===c.length)return{success:!0,message:"No auto-provision assets configured"};let{data:e}=await b.from("student_it_access").select("asset_id").eq("student_id",a),f=new Set(e?.map(a=>a.asset_id)||[]),g=[];for(let d of c){if(f.has(d.id))continue;let c=h(d.asset_type),e=new Date;e.setFullYear(e.getFullYear()+1);let{data:i,error:j}=await b.from("student_it_access").insert({student_id:a,asset_id:d.id,credentials:c,activated_at:new Date().toISOString(),expires_at:e.toISOString(),status:"ACTIVE"}).select().single();!j&&i&&(g.push(i),await b.from("it_assets").update({current_usage:d.current_usage+1}).eq("id",d.id))}return(0,d.revalidatePath)("/portal/student/it-access"),{success:!0,provisioned:g}}catch(a){return{success:!1,error:a.message}}}async function f(a){let b=(0,c.createAdminClient)();try{let{error:c}=await b.from("student_it_access").update({status:"DEACTIVATED",deactivated_at:new Date().toISOString()}).eq("student_id",a).in("status",["ACTIVE","PENDING"]);if(c)throw c;let{data:e}=await b.from("student_it_access").select("asset_id").eq("student_id",a).eq("status","DEACTIVATED");if(e)for(let a of e)await b.rpc("decrement_asset_usage",{asset_uuid:a.asset_id});return(0,d.revalidatePath)("/portal/student/it-access"),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function g(a,b){let e=(0,c.createAdminClient)();try{let{data:c}=await e.from("it_assets").select("*").eq("id",b).single();if(!c)throw Error("Asset not found");let f=h(c.asset_type),g=new Date;g.setFullYear(g.getFullYear()+1);let{data:i,error:j}=await e.from("student_it_access").upsert({student_id:a,asset_id:b,credentials:f,activated_at:new Date().toISOString(),expires_at:g.toISOString(),status:"ACTIVE"}).select().single();if(j)throw j;return(0,d.revalidatePath)("/admin/it-assets"),{success:!0,access:i}}catch(a){return{success:!1,error:a.message}}}function h(a){switch(a){case"EMAIL":return{email:`student${Math.floor(1e4*Math.random())}@sykli.edu`,password:"SET_ON_FIRST_LOGIN"};case"LMS":return{username:`student${Math.floor(1e4*Math.random())}`,access_token:`lms_${i()}`};case"VPN":return{vpn_key:i(),config_url:"https://vpn.sykli.edu/config"};case"LIBRARY":return{library_id:`LIB${Math.floor(1e5*Math.random())}`,pin:Math.floor(1e3+9e3*Math.random()).toString()};case"VIRTUAL_LAB":return{lab_username:`vlab_${Math.floor(1e4*Math.random())}`,access_url:"https://labs.sykli.edu"};default:return{license_key:i()}}}function i(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}(0,a.i(8649).ensureServerEntryExports)([e,f,g]),(0,b.registerServerReference)(e,"40193cfe8011168c69e76e6f0d1f2aa74333b0c00c",null),(0,b.registerServerReference)(f,"405546470cf23c6d6901f21ea99df9b1d136370dab",null),(0,b.registerServerReference)(g,"60274f106bb48ebe718ec77cc37efad2e71d3cc209",null),a.s(["deactivateItMaterials",()=>f,"manualProvisionItAsset",()=>g,"provisionItMaterials",()=>e])},73913,a=>{"use strict";var b=a.i(51696);a.s([],5452),a.i(5452),a.s(["60274f106bb48ebe718ec77cc37efad2e71d3cc209",()=>b.manualProvisionItAsset],73913)}];

//# sourceMappingURL=OneDrive_Documents_syklicollege_5e78731a._.js.map