module.exports=[67049,a=>{"use strict";function b(a){if(!a)return"-";let b=new Date(a);if(isNaN(b.getTime()))return"-";let c=String(b.getDate()).padStart(2,"0"),d=String(b.getMonth()+1).padStart(2,"0"),e=b.getFullYear();return`${c}/${d}/${e}`}a.s(["formatToDDMMYYYY",()=>b])},77782,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(46504)},8649,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},53565,a=>{"use strict";var b=a.i(96350);function c(){if(!process.env.SUPABASE_SERVICE_ROLE_KEY)throw Error("Missing Supabase Service Role Key");return(0,b.createClient)("https://mrqzlmkdhzwvbpljikjz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}a.s(["createAdminClient",()=>c])},21914,a=>{"use strict";var b=a.i(77782),c=a.i(2669),d=a.i(53565),e=a.i(46235);a.i(75325);var f=a.i(17781);async function g(a,b="content"){if(!a||0===a.size)return null;let d=await (0,c.createClient)(),e=a.name.split(".").pop(),f=`${Math.random().toString(36).substring(2)}.${e}`,h=`${f}`,{error:i,data:j}=await d.storage.from(b).upload(h,a);if(i)throw Error(i.message);let{data:{publicUrl:k}}=d.storage.from(b).getPublicUrl(h);return k}async function h(a){let b=await (0,c.createClient)(),d=a.get("title"),g=a.get("slug"),h=a.get("degreeLevel"),i=a.get("schoolId"),{error:j}=await b.from("Course").insert({title:d,slug:g,degreeLevel:h,schoolId:i,duration:a.get("duration")||"3 years",language:a.get("language")||"English",description:a.get("description"),tuitionFee:a.get("tuitionFee"),credits:parseInt(a.get("credits"))||0});if(j)throw Error(j.message);(0,e.revalidatePath)("/admin/courses"),(0,f.redirect)("/admin/courses")}async function i(a,b){let d=await (0,c.createClient)(),{error:g}=await d.from("Course").update({title:b.get("title"),slug:b.get("slug"),degreeLevel:b.get("degreeLevel"),schoolId:b.get("schoolId"),duration:b.get("duration"),language:b.get("language"),description:b.get("description"),tuitionFee:b.get("tuitionFee"),credits:parseInt(b.get("credits"))||0}).eq("id",a);if(g)throw Error(g.message);(0,e.revalidatePath)("/admin/courses"),(0,e.revalidatePath)(`/admin/courses/${a}`),(0,f.redirect)("/admin/courses")}async function j(a){let b=await (0,c.createClient)(),{error:d}=await b.from("Course").delete().eq("id",a);if(d)throw Error(d.message);(0,e.revalidatePath)("/admin/courses")}async function k(a){let b=await (0,c.createClient)(),d=a.get("title"),h=a.get("slug"),i=a.get("content"),j=a.get("image"),k=a.get("publishDate")||new Date().toISOString(),l=await g(j),{error:m}=await b.from("News").insert({title:d,slug:h,content:i,imageUrl:l,publishDate:k,published:"true"===a.get("published")});if(m)throw Error(m.message);(0,e.revalidatePath)("/admin/news"),(0,e.revalidatePath)("/news"),(0,e.revalidatePath)("/"),(0,f.redirect)("/admin/news")}async function l(a,b){let d=await (0,c.createClient)(),h=b.get("image"),i=await g(h),j={title:b.get("title"),slug:b.get("slug"),content:b.get("content"),publishDate:b.get("publishDate")};i&&(j.imageUrl=i);let{error:k}=await d.from("News").update(j).eq("id",a);if(k)throw Error(k.message);(0,e.revalidatePath)("/admin/news"),(0,e.revalidatePath)("/news"),(0,e.revalidatePath)("/"),(0,e.revalidatePath)(`/news/${a}`),(0,f.redirect)("/admin/news")}async function m(a){let b=await (0,c.createClient)(),{error:d}=await b.from("News").delete().eq("id",a);if(d)throw Error(d.message);(0,e.revalidatePath)("/admin/news"),(0,e.revalidatePath)("/news"),(0,e.revalidatePath)("/")}async function n(a){let b=await (0,c.createClient)(),d=a.get("image"),h=await g(d),{error:i}=await b.from("Event").insert({title:a.get("title"),slug:a.get("slug"),date:a.get("date"),location:a.get("location"),category:a.get("category"),content:a.get("content"),imageUrl:h,published:!0});if(i)throw Error(i.message);(0,e.revalidatePath)("/admin/events"),(0,e.revalidatePath)("/events"),(0,e.revalidatePath)("/"),(0,f.redirect)("/admin/events")}async function o(a,b){let d=await (0,c.createClient)(),h=b.get("image"),i=await g(h),j={title:b.get("title"),slug:b.get("slug"),date:b.get("date"),location:b.get("location"),category:b.get("category"),content:b.get("content")};i&&(j.imageUrl=i);let{error:k}=await d.from("Event").update(j).eq("id",a);if(k)throw Error(k.message);(0,e.revalidatePath)("/admin/events"),(0,e.revalidatePath)("/events"),(0,e.revalidatePath)("/"),(0,f.redirect)("/admin/events")}async function p(a){let b=await (0,c.createClient)(),{error:d}=await b.from("Event").delete().eq("id",a);if(d)throw Error(d.message);(0,e.revalidatePath)("/admin/events"),(0,e.revalidatePath)("/events"),(0,e.revalidatePath)("/")}async function q(a){let b=await (0,c.createClient)(),{error:d}=await b.from("Subject").insert({name:a.get("name"),creditUnits:parseInt(a.get("creditUnits"))||5,semester:parseInt(a.get("semester"))||1,courseId:a.get("courseId"),code:a.get("code"),area:a.get("area")});if(d)throw Error(d.message);(0,e.revalidatePath)("/admin/subjects"),(0,f.redirect)("/admin/subjects")}async function r(a,b){let d=await (0,c.createClient)(),{error:g}=await d.from("Subject").update({name:b.get("name"),creditUnits:parseInt(b.get("creditUnits"))||5,semester:parseInt(b.get("semester"))||1,courseId:b.get("courseId"),code:b.get("code"),area:b.get("area")}).eq("id",a);if(g)throw Error(g.message);(0,e.revalidatePath)("/admin/subjects"),(0,f.redirect)("/admin/subjects")}async function s(a){let b=await (0,c.createClient)(),{error:d}=await b.from("Subject").delete().eq("id",a);if(d)throw Error(d.message);(0,e.revalidatePath)("/admin/subjects")}async function t(a,b){let d=await (0,c.createClient)(),{error:f}=await d.from("Student").update({status:b}).eq("id",a);if(f)throw Error(f.message);(0,e.revalidatePath)("/admin/students")}async function u(a,b){let d=await (0,c.createClient)(),f="true"===b.get("tuitionPaid"),g=b.get("tuitionAmount"),{error:h}=await d.from("Student").update({tuitionPaid:f,tuitionAmount:g,paymentDate:f?new Date().toISOString():null}).eq("id",a);if(h)throw Error(h.message);(0,e.revalidatePath)("/admin/students")}async function v(a){let b=(0,d.createAdminClient)(),{error:c}=await b.from("module_enrollments").delete().eq("student_id",a);if(c)throw Error(`Failed to clear enrollments: ${c.message}`);let{error:f}=await b.from("students").delete().eq("id",a);if(f)throw Error(f.message);(0,e.revalidatePath)("/admin/students")}async function w(a){let b=await (0,c.createClient)(),d=a.get("image"),h=await g(d),{error:i}=await b.from("Faculty").insert({name:a.get("name"),role:a.get("role"),bio:a.get("bio"),email:a.get("email"),schoolId:a.get("schoolId"),departmentId:a.get("departmentId")||null,imageUrl:h});if(i)throw Error(i.message);(0,e.revalidatePath)("/admin/faculty"),(0,e.revalidatePath)("/schools/arts"),(0,e.revalidatePath)("/schools/[slug]","layout"),(0,f.redirect)("/admin/faculty")}async function x(a,b){let d=await (0,c.createClient)(),h=b.get("image"),i=await g(h),j={name:b.get("name"),role:b.get("role"),bio:b.get("bio"),email:b.get("email"),schoolId:b.get("schoolId"),departmentId:b.get("departmentId")||null};i&&(j.imageUrl=i);let{error:k}=await d.from("Faculty").update(j).eq("id",a);if(k)throw Error(k.message);(0,e.revalidatePath)("/admin/faculty"),(0,e.revalidatePath)("/schools/arts"),(0,e.revalidatePath)("/schools/[slug]","layout"),(0,f.redirect)("/admin/faculty")}async function y(a){let b=await (0,c.createClient)(),{error:d}=await b.from("Faculty").delete().eq("id",a);if(d)throw Error(d.message);(0,e.revalidatePath)("/admin/faculty"),(0,e.revalidatePath)("/schools/arts"),(0,e.revalidatePath)("/schools/[slug]","layout")}async function z(b){let f=await (0,c.createClient)(),g=(0,d.createAdminClient)(),{data:h}=await f.from("applications").select("*, offer:admission_offers(*)").eq("id",b).single();if(!h||!h.offer?.[0])throw Error("Application or Offer not found");let i=h.offer[0],{data:j}=await f.from("tuition_payments").select("*").eq("offer_id",i.id).single();j?"COMPLETED"!==j.status&&await g.from("tuition_payments").update({status:"COMPLETED"}).eq("id",j.id):await g.from("tuition_payments").insert({offer_id:i.id,amount:i.tuition_fee,status:"COMPLETED",payment_method:"MANUAL_ADMIN_OVERRIDE",transaction_reference:`MANUAL-${new Date().getTime()}`});let{confirmEnrollment:k}=await a.A(91073),l=await k(b);if(!l.success)throw Error(l.error||"Enrollment failed");(0,e.revalidatePath)("/admin/students")}async function A(a){console.log("SERVER ACTION: createResearchProject called");try{let b=await (0,c.createClient)(),d=a.get("image"),e=await g(d),{error:f}=await b.from("ResearchProject").insert({title:a.get("title"),slug:a.get("slug"),leadResearcher:a.get("leadResearcher"),fundingSource:a.get("fundingSource"),description:a.get("description"),content:a.get("content"),imageUrl:e});if(f)throw Error(f.message)}catch(a){throw console.error("Create Research Project Error:",a),Error(a.message)}(0,e.revalidatePath)("/admin/research/projects"),(0,e.revalidatePath)("/research/projects"),(0,f.redirect)("/admin/research/projects")}async function B(a,b){try{console.log("SERVER ACTION: updateResearchProject",a);let d=await (0,c.createClient)(),e=b.get("image");console.log("Image from FormData:",{name:e?.name,size:e?.size,type:e?.type});let f=await g(e);console.log("Uploaded Image URL:",f);let h={title:b.get("title"),slug:b.get("slug"),leadResearcher:b.get("leadResearcher"),fundingSource:b.get("fundingSource"),description:b.get("description"),content:b.get("content"),updatedAt:new Date().toISOString()};f?(console.log("Updating imageUrl in DB to:",f),h.imageUrl=f):console.log("No new image uploaded, keeping existing.");let{error:i}=await d.from("ResearchProject").update(h).eq("id",a);if(i)throw Error(i.message)}catch(a){throw console.error("Update Research Project Error:",a),Error(a.message)}(0,e.revalidatePath)("/admin/research/projects"),(0,e.revalidatePath)("/research/projects"),(0,f.redirect)("/admin/research/projects")}async function C(a){let b=a.get("id"),d=await (0,c.createClient)(),{error:f}=await d.from("ResearchProject").delete().eq("id",b);if(f)throw Error(f.message);(0,e.revalidatePath)("/admin/research/projects"),(0,e.revalidatePath)("/research/projects")}(0,a.i(8649).ensureServerEntryExports)([h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C]),(0,b.registerServerReference)(h,"40c4f6cecb415f91dccfdf4b6804ad7d408b93d302",null),(0,b.registerServerReference)(i,"606bb119db4d01508dd9a0e9d4cae341d60be8d638",null),(0,b.registerServerReference)(j,"40e06727a6ec98ad908a0e2c2f18b1b1f110a03ea5",null),(0,b.registerServerReference)(k,"4013c675e4dedebb589f5e4819dd96e0e4f68b79eb",null),(0,b.registerServerReference)(l,"605cd578a609d9fa9be450c74fe73b502a39e63d86",null),(0,b.registerServerReference)(m,"4069757fa481d073818e16ce3b53a4c65cc604f3d6",null),(0,b.registerServerReference)(n,"4086c35e787f554e2bd02c3c6df7fd8b0962497ad0",null),(0,b.registerServerReference)(o,"60b87372ef299d4233c31dd6810e1948f1328c8d50",null),(0,b.registerServerReference)(p,"40645e073b962afd65040b994b1826fd74d761b568",null),(0,b.registerServerReference)(q,"40bd5e3815bc037f424117d3e6ce57ee165d17070d",null),(0,b.registerServerReference)(r,"602a2b5389c973210a5dd1c205aab96bf9fbf0a3b8",null),(0,b.registerServerReference)(s,"4018e75f34490ef6a424f8b0bf41893c8302f205c5",null),(0,b.registerServerReference)(t,"60dabbb28c637e84cb3e014d4e5af6dc5a3c3cd2fa",null),(0,b.registerServerReference)(u,"60e541f372ee312a0e08d67be1e73647cf49309c4b",null),(0,b.registerServerReference)(v,"4016e22860391f57bb05f62130bd888de85a18477d",null),(0,b.registerServerReference)(w,"40945c12ae9e6e704fa4a20b28cb7c34d10f70340c",null),(0,b.registerServerReference)(x,"6098d41a2e8c7b0fc1854e84bfc5aff6341b86c215",null),(0,b.registerServerReference)(y,"409185f09b37b2209c4d3a6d2df75a0e0fd895b0c2",null),(0,b.registerServerReference)(z,"40b47784dc36f7651e793601228847fdcaf936d366",null),(0,b.registerServerReference)(A,"408ca9c7d3ad6e9c8e5125e1352da6f602fb6dfa3f",null),(0,b.registerServerReference)(B,"60292347994a66ea1084d491bd60af178761ee958d",null),(0,b.registerServerReference)(C,"40deceded8eb478c7ef2c4898ac99c758b7f8d8143",null),a.s(["adminApproveTuition",()=>z,"createCourse",()=>h,"createEvent",()=>n,"createFaculty",()=>w,"createNews",()=>k,"createResearchProject",()=>A,"createSubject",()=>q,"deleteCourse",()=>j,"deleteEvent",()=>p,"deleteFaculty",()=>y,"deleteNews",()=>m,"deleteResearchProject",()=>C,"deleteStudent",()=>v,"deleteSubject",()=>s,"updateCourse",()=>i,"updateEvent",()=>o,"updateFaculty",()=>x,"updateNews",()=>l,"updateResearchProject",()=>B,"updateStudentStatus",()=>t,"updateStudentTuition",()=>u,"updateSubject",()=>r])},51080,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getClientReferenceManifest:function(){return q},getServerActionsManifest:function(){return r},getServerModuleMap:function(){return s},selectWorkerForForwarding:function(){return n},setManifestsSingleton:function(){return o}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(77466),g=a.r(92525),h=a.r(83918),i=a.r(84180),j=a.r(56704),k=Symbol.for("next.server.manifests"),l=globalThis;function m(a){return(0,h.pathHasPrefix)(a,"app")?a:"app"+a}function n(a,b){var c,d;let e=null==(c=r().node[a])?void 0:c.workers;if(e&&!e[m(b)])return d=Object.keys(e)[0],(0,g.normalizeAppPath)((0,i.removePathPrefix)(d,"app"))}function o({page:a,clientReferenceManifest:b,serverActionsManifest:c}){let d=l[k];if(d)d.clientReferenceManifestsPerRoute.set((0,g.normalizeAppPath)(a),b),d.serverActionsManifest=c;else{let d,e=new Map([[(0,g.normalizeAppPath)(a),b]]),h=(d=new Map,new Proxy({},{get(a,b){let c=j.workAsyncStorage.getStore();switch(b){case"moduleLoading":case"entryCSSFiles":case"entryJSFiles":{if(!c)throw Object.defineProperty(new f.InvariantError(`Cannot access "${b}" without a work store.`),"__NEXT_ERROR_CODE",{value:"E952",enumerable:!1,configurable:!0});let a=e.get(c.route);if(!a)throw Object.defineProperty(new f.InvariantError(`The client reference manifest for route "${c.route}" does not exist.`),"__NEXT_ERROR_CODE",{value:"E951",enumerable:!1,configurable:!0});return a[b]}case"clientModules":case"rscModuleMapping":case"edgeRscModuleMapping":case"ssrModuleMapping":case"edgeSSRModuleMapping":{let a=d.get(b);!a&&(a=new Proxy({},{get(a,c){let d=j.workAsyncStorage.getStore();if(d){let a=e.get(d.route);if(null==a?void 0:a[b][c])return a[b][c]}else for(let a of e.values()){let d=a[b][c];if(void 0!==d)return d}}}),d.set(b,a));return a}default:throw Object.defineProperty(new f.InvariantError(`This is a proxied client reference manifest. The property "${String(b)}" is not handled.`),"__NEXT_ERROR_CODE",{value:"E953",enumerable:!1,configurable:!0})}}}));l[k]={clientReferenceManifestsPerRoute:e,proxiedClientReferenceManifest:h,serverActionsManifest:c,serverModuleMap:new Proxy({},{get:(a,b)=>{var c,d;let e,f=null==(d=r().node)||null==(c=d[b])?void 0:c.workers;if(!f)return;let g=j.workAsyncStorage.getStore();if(!(e=g?f[m(g.page)]:Object.values(f).at(0)))return;let{moduleId:h,async:i}=e;return{id:h,name:b,chunks:[],async:i}}})}}}function p(){let a=l[k];if(!a)throw Object.defineProperty(new f.InvariantError("The manifests singleton was not initialized."),"__NEXT_ERROR_CODE",{value:"E950",enumerable:!1,configurable:!0});return a}function q(){return p().proxiedClientReferenceManifest}function r(){return p().serverActionsManifest}function s(){return p().serverModuleMap}},61034,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});var e={arrayBufferToString:function(){return i},decrypt:function(){return l},encrypt:function(){return k},getActionEncryptionKey:function(){return m},stringToUint8Array:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(77466),h=a.r(51080);function i(a){let b=new Uint8Array(a),c=b.byteLength;if(c<65535)return String.fromCharCode.apply(null,b);let d="";for(let a=0;a<c;a++)d+=String.fromCharCode(b[a]);return d}function j(a){let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}function k(a,b,c){return crypto.subtle.encrypt({name:"AES-GCM",iv:b},a,c)}function l(a,b,c){return crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c)}async function m(){if(d)return d;let a=(0,h.getServerActionsManifest)(),b=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||a.encryptionKey;if(void 0===b)throw Object.defineProperty(new g.InvariantError("Missing encryption key for Server Actions"),"__NEXT_ERROR_CODE",{value:"E571",enumerable:!1,configurable:!0});return d=await crypto.subtle.importKey("raw",j(atob(b)),"AES-GCM",!0,["encrypt","decrypt"])}},98630,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={decryptActionBoundArgs:function(){return x},encryptActionBoundArgs:function(){return w}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});a.r(23779);let h=a.r(46504),i=a.r(92326),j=a.r(56087),k=a.r(61034),l=a.r(51080),m=a.r(32319),n=a.r(96648),o=(d=a.r(60550))&&d.__esModule?d:{default:d},p=new TextEncoder,q=new TextDecoder,r,s;async function t(a,b){let c=await (0,k.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),g=q.decode(await (0,k.decrypt)(c,(0,k.stringToUint8Array)(e),(0,k.stringToUint8Array)(f)));if(!g.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return g.slice(a.length)}async function u(a,b){let c=await (0,k.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);m.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,k.arrayBufferToString)(d.buffer),f=await (0,k.encrypt)(c,d,p.encode(a+b));return btoa(e+(0,k.arrayBufferToString)(f))}var v=((e=v||{})[e.Ready=0]="Ready",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete",e);let w=o.default.cache(async function a(b,...c){let d=m.workUnitAsyncStorage.getStore(),e=d?(0,m.getCacheSignal)(d):void 0,{clientModules:f}=(0,l.getClientReferenceManifest)(),g=Error();Error.captureStackTrace(g,a);let i=!1,k=d?(0,n.createHangingInputAbortSignal)(d):void 0,o=0;function p(){0===o&&(o=1,null==e||e.beginRead())}function q(){1===o&&(null==e||e.endRead()),o=2}k&&e&&k.addEventListener("abort",p,{once:!0});let s=await (0,j.streamToString)((0,h.renderToReadableStream)(c,f,{filterStackFrame:r,signal:k,onError(a){(null==k?void 0:k.aborted)||i||(i=!0,g.message=a instanceof Error?a.message:String(a))}}),k);if(i)throw q(),g;if(!d)return u(b,s);p();let t=(0,m.getPrerenderResumeDataCache)(d),v=(0,m.getRenderResumeDataCache)(d),w=b+s,x=(null==t?void 0:t.encryptedBoundArgs.get(w))??(null==v?void 0:v.encryptedBoundArgs.get(w));if(x)return x;let y=await u(b,s);return q(),null==t||t.encryptedBoundArgs.set(w,y),y});async function x(a,b){let c,d=await b,e=m.workUnitAsyncStorage.getStore();if(e){let b=(0,m.getCacheSignal)(e),f=(0,m.getPrerenderResumeDataCache)(e),g=(0,m.getRenderResumeDataCache)(e);(c=(null==f?void 0:f.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await t(a,d),null==b||b.endRead(),null==f||f.decryptedBoundArgs.set(d,c))}else c=await t(a,d);let{edgeRscModuleMapping:f,rscModuleMapping:g}=(0,l.getClientReferenceManifest)();return await (0,i.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(p.encode(c)),null==e?void 0:e.type){case"prerender":case"prerender-runtime":e.renderSignal.aborted?a.close():e.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:s,serverConsumerManifest:{moduleLoading:null,moduleMap:g,serverModuleMap:(0,l.getServerModuleMap)()}})}},33199,a=>{"use strict";var b=a.i(77782),c=a.i(2669),d=a.i(53565),e=a.i(46235),f=a.i(66832),g=a.i(51696);async function h(a){let b=await (0,c.createClient)(),h=(0,d.createAdminClient)(),{data:{user:i}}=await b.auth.getUser();if(!i)throw Error("Unauthorized");try{let{data:b,error:c}=await h.from("applications").select(`
                *,
                user:profiles(*),
                course:Course(*),
                offer:admission_offers!inner(*)
            `).eq("id",a).single();if(c||!b)throw console.error("App fetch error:",c),Error("Application not found");let d=b.offer[0],{data:j}=await h.from("tuition_payments").select("*").eq("offer_id",d.id).eq("status","COMPLETED").single();if("ENROLLED"===b.status)return{success:!0,message:"Student is already enrolled."};if("PAYMENT_SUBMITTED"!==b.status&&"OFFER_ACCEPTED"!==b.status)throw Error(`Invalid application status for enrollment: ${b.status}`);let{data:k}=await h.from("students").select("student_id").eq("application_id",a).single();if(k)return"ENROLLED"!==b.status&&await h.from("applications").update({status:"ENROLLED"}).eq("id",a),{success:!0,studentId:k.student_id,message:"Student was already enrolled."};let l=`SYK-${new Date().getFullYear()}-${Math.floor(1e3+9e3*Math.random())}`,m=b.user;if(!m)throw Error("Applicant profile not found");let n=m.first_name||"Student",o=m.last_name||"Sykli",p=`${n.toLowerCase()}.${o.toLowerCase()}@syklicollege.fi`.replace(/\s/g,""),q=0;for(;;){let{data:a}=await h.from("students").select("id").eq("institutional_email",p).single();if(!a)break;q++,p=`${n.toLowerCase()}.${o.toLowerCase()}${q}@syklicollege.fi`.replace(/\s/g,"")}let{error:r,data:s}=await h.from("students").insert({user_id:b.user_id,student_id:l,application_id:a,program_id:b.course_id,enrollment_status:"ACTIVE",institutional_email:p,personal_email:m.email,start_date:new Date().toISOString(),expected_graduation_date:new Date(new Date().setFullYear(new Date().getFullYear()+3)).toISOString()}).select().single();if(r)throw console.error("SIS Creation Failed:",r),Error(`Failed to create student record: ${r.message}`);let{error:t}=await h.from("applications").update({status:"ENROLLED"}).eq("id",a);if(t)throw t;await h.from("audit_logs").insert({action:"ENROLLMENT_CONFIRMED",entity_table:"students",entity_id:l,actor_id:i.id,metadata:{previous_status:b.status,trigger:"TUITION_PAYMENT_VERIFIED",payment_ref:j?.transaction_reference,actor_role:i.id===b.user_id?"APPLICANT":"ADMIN"}});try{await (0,f.provisionLmsAccount)(s.id,p)}catch(a){console.error("LMS Provisioning deferred:",a)}try{await (0,g.provisionItMaterials)(s.id)}catch(a){console.error("IT Materials provisioning deferred:",a)}return(0,e.revalidatePath)("/portal/dashboard"),{success:!0,studentId:l}}catch(a){return console.error("Enrollment Error:",a),{success:!1,error:a.message||"Enrollment failed."}}}(0,a.i(8649).ensureServerEntryExports)([h]),(0,b.registerServerReference)(h,"408cdf7281b5d7026053f987c0c9a13f936daa5cf9",null),a.s(["confirmEnrollment",()=>h])},66832,a=>{"use strict";var b=a.i(77782),c=a.i(53565);async function d(a,b){let d=(0,c.createAdminClient)();console.log(`[LMS Simulation] Provisioning account for ${a} (${b})...`);try{await new Promise(a=>setTimeout(a,800));let c=`LX-${Math.random().toString(36).substring(2,10).toUpperCase()}`,{error:e}=await d.from("students").update({lms_access_data:{account_provisioned:!0,provisioned_at:new Date().toISOString(),lms_token:c,sync_status:"SYNCED"}}).eq("id",a);if(e)throw e;return await d.from("audit_logs").insert({action:"LMS_ACCOUNT_PROVISIONED",entity_table:"students",entity_id:a,metadata:{lms_token:c,email:b}}),console.log(`[LMS Simulation] Account provisioned successfully for ${a}`),{success:!0,lmsToken:c}}catch(a){return console.error("[LMS Simulation] Provisioning failed:",a.message),{success:!1,error:a.message}}}async function e(a,b,d){let e=(0,c.createAdminClient)();console.log(`[LMS Simulation] Syncing module ${b} to LMS for student ${a}...`);try{return await new Promise(a=>setTimeout(a,500)),await e.from("audit_logs").insert({action:"LMS_COURSE_SYNC",entity_table:"module_enrollments",entity_id:`${a}:${b}`,metadata:{student_id:a,module_id:b,semester_id:d,status:"GRANTED"}}),console.log(`[LMS Simulation] Sync completed for ${a} -> ${b}`),{success:!0}}catch(a){return console.error("[LMS Simulation] Sync failed:",a.message),{success:!1,error:a.message}}}(0,a.i(8649).ensureServerEntryExports)([d,e]),(0,b.registerServerReference)(d,"6052a37213a0498364a0c50f9dd077fb0b0bab16a9",null),(0,b.registerServerReference)(e,"70b81b98bfbfaaf3a696ecfc2de0bd424ed369fd46",null),a.s(["provisionLmsAccount",()=>d,"syncEnrollmentToLms",()=>e])},51696,a=>{"use strict";var b=a.i(77782),c=a.i(53565),d=a.i(46235);async function e(a){let b=(0,c.createAdminClient)();try{let{data:c}=await b.from("it_assets").select("*").eq("auto_provision",!0);if(!c||0===c.length)return{success:!0,message:"No auto-provision assets configured"};let{data:e}=await b.from("student_it_access").select("asset_id").eq("student_id",a),f=new Set(e?.map(a=>a.asset_id)||[]),g=[];for(let d of c){if(f.has(d.id))continue;let c=h(d.asset_type),e=new Date;e.setFullYear(e.getFullYear()+1);let{data:i,error:j}=await b.from("student_it_access").insert({student_id:a,asset_id:d.id,credentials:c,activated_at:new Date().toISOString(),expires_at:e.toISOString(),status:"ACTIVE"}).select().single();!j&&i&&(g.push(i),await b.from("it_assets").update({current_usage:d.current_usage+1}).eq("id",d.id))}return(0,d.revalidatePath)("/portal/student/it-access"),{success:!0,provisioned:g}}catch(a){return{success:!1,error:a.message}}}async function f(a){let b=(0,c.createAdminClient)();try{let{error:c}=await b.from("student_it_access").update({status:"DEACTIVATED",deactivated_at:new Date().toISOString()}).eq("student_id",a).in("status",["ACTIVE","PENDING"]);if(c)throw c;let{data:e}=await b.from("student_it_access").select("asset_id").eq("student_id",a).eq("status","DEACTIVATED");if(e)for(let a of e)await b.rpc("decrement_asset_usage",{asset_uuid:a.asset_id});return(0,d.revalidatePath)("/portal/student/it-access"),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function g(a,b){let e=(0,c.createAdminClient)();try{let{data:c}=await e.from("it_assets").select("*").eq("id",b).single();if(!c)throw Error("Asset not found");let f=h(c.asset_type),g=new Date;g.setFullYear(g.getFullYear()+1);let{data:i,error:j}=await e.from("student_it_access").upsert({student_id:a,asset_id:b,credentials:f,activated_at:new Date().toISOString(),expires_at:g.toISOString(),status:"ACTIVE"}).select().single();if(j)throw j;return(0,d.revalidatePath)("/admin/it-assets"),{success:!0,access:i}}catch(a){return{success:!1,error:a.message}}}function h(a){switch(a){case"EMAIL":return{email:`student${Math.floor(1e4*Math.random())}@sykli.edu`,password:"SET_ON_FIRST_LOGIN"};case"LMS":return{username:`student${Math.floor(1e4*Math.random())}`,access_token:`lms_${i()}`};case"VPN":return{vpn_key:i(),config_url:"https://vpn.sykli.edu/config"};case"LIBRARY":return{library_id:`LIB${Math.floor(1e5*Math.random())}`,pin:Math.floor(1e3+9e3*Math.random()).toString()};case"VIRTUAL_LAB":return{lab_username:`vlab_${Math.floor(1e4*Math.random())}`,access_url:"https://labs.sykli.edu"};default:return{license_key:i()}}}function i(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}(0,a.i(8649).ensureServerEntryExports)([e,f,g]),(0,b.registerServerReference)(e,"40193cfe8011168c69e76e6f0d1f2aa74333b0c00c",null),(0,b.registerServerReference)(f,"405546470cf23c6d6901f21ea99df9b1d136370dab",null),(0,b.registerServerReference)(g,"60274f106bb48ebe718ec77cc37efad2e71d3cc209",null),a.s(["deactivateItMaterials",()=>f,"manualProvisionItAsset",()=>g,"provisionItMaterials",()=>e])},56040,a=>{"use strict";var b=a.i(60550),c=a.i(64040);let d=new Map([["bold",b.createElement(b.Fragment,null,b.createElement("path",{d:"M230.14,70.54,185.46,25.85a20,20,0,0,0-28.29,0L33.86,149.17A19.85,19.85,0,0,0,28,163.31V208a20,20,0,0,0,20,20H92.69a19.86,19.86,0,0,0,14.14-5.86L230.14,98.82a20,20,0,0,0,0-28.28ZM91,204H52V165l84-84,39,39ZM192,103,153,64l18.34-18.34,39,39Z"}))],["duotone",b.createElement(b.Fragment,null,b.createElement("path",{d:"M221.66,90.34,192,120,136,64l29.66-29.66a8,8,0,0,1,11.31,0L221.66,79A8,8,0,0,1,221.66,90.34Z",opacity:"0.2"}),b.createElement("path",{d:"M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"}))],["fill",b.createElement(b.Fragment,null,b.createElement("path",{d:"M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM192,108.68,147.31,64l24-24L216,84.68Z"}))],["light",b.createElement(b.Fragment,null,b.createElement("path",{d:"M225.9,74.78,181.21,30.09a14,14,0,0,0-19.8,0L38.1,153.41a13.94,13.94,0,0,0-4.1,9.9V208a14,14,0,0,0,14,14H92.69a13.94,13.94,0,0,0,9.9-4.1L225.9,94.58a14,14,0,0,0,0-19.8ZM94.1,209.41a2,2,0,0,1-1.41.59H48a2,2,0,0,1-2-2V163.31a2,2,0,0,1,.59-1.41L136,72.48,183.51,120ZM217.41,86.1,192,111.51,144.49,64,169.9,38.58a2,2,0,0,1,2.83,0l44.68,44.69a2,2,0,0,1,0,2.83Z"}))],["regular",b.createElement(b.Fragment,null,b.createElement("path",{d:"M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"}))],["thin",b.createElement(b.Fragment,null,b.createElement("path",{d:"M224.49,76.2,179.8,31.51a12,12,0,0,0-17,0L133.17,61.17h0L39.52,154.83A11.9,11.9,0,0,0,36,163.31V208a12,12,0,0,0,12,12H92.69a12,12,0,0,0,8.48-3.51L224.48,93.17a12,12,0,0,0,0-17Zm-129,134.63A4,4,0,0,1,92.69,212H48a4,4,0,0,1-4-4V163.31a4,4,0,0,1,1.17-2.83L136,69.65,186.34,120ZM218.83,87.51,192,114.34,141.66,64l26.82-26.83a4,4,0,0,1,5.66,0l44.69,44.68a4,4,0,0,1,0,5.66Z"}))]]),e=b.forwardRef((a,e)=>b.createElement(c.default,{ref:e,...a,weights:d}));e.displayName="PencilSimpleIcon",a.s(["PencilSimple",()=>e],56040)},27208,a=>{"use strict";var b=a.i(60550),c=a.i(64040);let d=new Map([["bold",b.createElement(b.Fragment,null,b.createElement("path",{d:"M216,48H180V36A28,28,0,0,0,152,8H104A28,28,0,0,0,76,36V48H40a12,12,0,0,0,0,24h4V208a20,20,0,0,0,20,20H192a20,20,0,0,0,20-20V72h4a12,12,0,0,0,0-24ZM100,36a4,4,0,0,1,4-4h48a4,4,0,0,1,4,4V48H100Zm88,168H68V72H188ZM116,104v64a12,12,0,0,1-24,0V104a12,12,0,0,1,24,0Zm48,0v64a12,12,0,0,1-24,0V104a12,12,0,0,1,24,0Z"}))],["duotone",b.createElement(b.Fragment,null,b.createElement("path",{d:"M200,56V208a8,8,0,0,1-8,8H64a8,8,0,0,1-8-8V56Z",opacity:"0.2"}),b.createElement("path",{d:"M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"}))],["fill",b.createElement(b.Fragment,null,b.createElement("path",{d:"M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM112,168a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm0-120H96V40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Z"}))],["light",b.createElement(b.Fragment,null,b.createElement("path",{d:"M216,50H174V40a22,22,0,0,0-22-22H104A22,22,0,0,0,82,40V50H40a6,6,0,0,0,0,12H50V208a14,14,0,0,0,14,14H192a14,14,0,0,0,14-14V62h10a6,6,0,0,0,0-12ZM94,40a10,10,0,0,1,10-10h48a10,10,0,0,1,10,10V50H94ZM194,208a2,2,0,0,1-2,2H64a2,2,0,0,1-2-2V62H194ZM110,104v64a6,6,0,0,1-12,0V104a6,6,0,0,1,12,0Zm48,0v64a6,6,0,0,1-12,0V104a6,6,0,0,1,12,0Z"}))],["regular",b.createElement(b.Fragment,null,b.createElement("path",{d:"M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"}))],["thin",b.createElement(b.Fragment,null,b.createElement("path",{d:"M216,52H172V40a20,20,0,0,0-20-20H104A20,20,0,0,0,84,40V52H40a4,4,0,0,0,0,8H52V208a12,12,0,0,0,12,12H192a12,12,0,0,0,12-12V60h12a4,4,0,0,0,0-8ZM92,40a12,12,0,0,1,12-12h48a12,12,0,0,1,12,12V52H92ZM196,208a4,4,0,0,1-4,4H64a4,4,0,0,1-4-4V60H196ZM108,104v64a4,4,0,0,1-8,0V104a4,4,0,0,1,8,0Zm48,0v64a4,4,0,0,1-8,0V104a4,4,0,0,1,8,0Z"}))]]),e=b.forwardRef((a,e)=>b.createElement(c.default,{ref:e,...a,weights:d}));e.displayName="TrashIcon",a.s(["Trash",()=>e],27208)},74743,a=>{"use strict";var b=a.i(37875),c=a.i(77782),d=a.i(98630),e=a.i(2669),f=a.i(21914),g=a.i(27208),h=a.i(56040),i=a.i(86295),j=a.i(67049);let k=async function(a){var[b]=await (0,d.decryptActionBoundArgs)("408aa024820164d0b482150ba4095c51db33a5c2a3",a);await (0,f.deleteNews)(b)};async function l(){let a=await (0,e.createClient)(),{data:c}=await a.from("News").select("*").order("publishDate",{ascending:!1});return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Manage News"}),(0,b.jsx)(i.default,{href:"/admin/news/new",className:"bg-neutral-900 text-white px-4 py-2 rounded-lg font-bold hover:bg-neutral-800 transition-colors",children:"+ New Article"})]}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full text-left",children:[(0,b.jsx)("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-4 font-semibold text-neutral-600",children:"Title"}),(0,b.jsx)("th",{className:"p-4 font-semibold text-neutral-600",children:"Published"}),(0,b.jsx)("th",{className:"p-4 font-semibold text-neutral-600 text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-neutral-100",children:c?.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-neutral-50 group",children:[(0,b.jsx)("td",{className:"p-4 font-medium text-neutral-900",children:a.title}),(0,b.jsx)("td",{className:"p-4 text-neutral-600",children:(0,j.formatToDDMMYYYY)(a.publishDate)}),(0,b.jsx)("td",{className:"p-4 text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)(i.default,{href:`/admin/news/${a.id}`,className:"p-2 border border-neutral-200 rounded-lg hover:bg-neutral-50",title:"Edit",children:(0,b.jsx)(h.PencilSimple,{size:16,weight:"bold"})}),(0,b.jsx)("form",{action:k.bind(null,(0,d.encryptActionBoundArgs)("408aa024820164d0b482150ba4095c51db33a5c2a3",a.id)),children:(0,b.jsx)("button",{className:"p-2 border border-neutral-200 rounded-lg hover:bg-red-50 text-red-600",title:"Delete",children:(0,b.jsx)(g.Trash,{size:16,weight:"bold"})})})]})})]},a.id))})]})})]})}(0,c.registerServerReference)(k,"408aa024820164d0b482150ba4095c51db33a5c2a3",null),a.s(["$$RSC_SERVER_ACTION_0",0,k,"default",()=>l,"revalidate",0,0])},73113,a=>{"use strict";var b=a.i(74743),c=a.i(21914),d=a.i(33199),e=a.i(66832),f=a.i(51696);a.s([],76416),a.i(76416),a.s(["4013c675e4dedebb589f5e4819dd96e0e4f68b79eb",()=>c.createNews,"4016e22860391f57bb05f62130bd888de85a18477d",()=>c.deleteStudent,"4018e75f34490ef6a424f8b0bf41893c8302f205c5",()=>c.deleteSubject,"40193cfe8011168c69e76e6f0d1f2aa74333b0c00c",()=>f.provisionItMaterials,"405546470cf23c6d6901f21ea99df9b1d136370dab",()=>f.deactivateItMaterials,"40645e073b962afd65040b994b1826fd74d761b568",()=>c.deleteEvent,"4069757fa481d073818e16ce3b53a4c65cc604f3d6",()=>c.deleteNews,"4086c35e787f554e2bd02c3c6df7fd8b0962497ad0",()=>c.createEvent,"408aa024820164d0b482150ba4095c51db33a5c2a3",()=>b.$$RSC_SERVER_ACTION_0,"408ca9c7d3ad6e9c8e5125e1352da6f602fb6dfa3f",()=>c.createResearchProject,"408cdf7281b5d7026053f987c0c9a13f936daa5cf9",()=>d.confirmEnrollment,"409185f09b37b2209c4d3a6d2df75a0e0fd895b0c2",()=>c.deleteFaculty,"40945c12ae9e6e704fa4a20b28cb7c34d10f70340c",()=>c.createFaculty,"40b47784dc36f7651e793601228847fdcaf936d366",()=>c.adminApproveTuition,"40bd5e3815bc037f424117d3e6ce57ee165d17070d",()=>c.createSubject,"40c4f6cecb415f91dccfdf4b6804ad7d408b93d302",()=>c.createCourse,"40deceded8eb478c7ef2c4898ac99c758b7f8d8143",()=>c.deleteResearchProject,"40e06727a6ec98ad908a0e2c2f18b1b1f110a03ea5",()=>c.deleteCourse,"60274f106bb48ebe718ec77cc37efad2e71d3cc209",()=>f.manualProvisionItAsset,"60292347994a66ea1084d491bd60af178761ee958d",()=>c.updateResearchProject,"602a2b5389c973210a5dd1c205aab96bf9fbf0a3b8",()=>c.updateSubject,"6052a37213a0498364a0c50f9dd077fb0b0bab16a9",()=>e.provisionLmsAccount,"605cd578a609d9fa9be450c74fe73b502a39e63d86",()=>c.updateNews,"606bb119db4d01508dd9a0e9d4cae341d60be8d638",()=>c.updateCourse,"6098d41a2e8c7b0fc1854e84bfc5aff6341b86c215",()=>c.updateFaculty,"60b87372ef299d4233c31dd6810e1948f1328c8d50",()=>c.updateEvent,"60dabbb28c637e84cb3e014d4e5af6dc5a3c3cd2fa",()=>c.updateStudentStatus,"60e541f372ee312a0e08d67be1e73647cf49309c4b",()=>c.updateStudentTuition,"70b81b98bfbfaaf3a696ecfc2de0bd424ed369fd46",()=>e.syncEnrollmentToLms],73113)},91073,a=>{a.v(a=>Promise.resolve().then(()=>a(33199)))}];

//# sourceMappingURL=OneDrive_Documents_syklicollege_ff611b29._.js.map